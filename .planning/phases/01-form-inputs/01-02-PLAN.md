---
phase: 01-form-inputs
plan: 02
type: execute
wave: 2
depends_on: ["01-01"]
files_modified:
  - packages/registry/ui/textarea.tsx
  - packages/registry/ui/select.tsx
autonomous: true

must_haves:
  truths:
    - "Textarea uses centralized tokens from components.textarea[size]"
    - "Textarea supports size prop (sm/md/lg) affecting all dimensions"
    - "Select uses centralized tokens from components.select[size]"
    - "Select supports size prop (sm/md/lg) affecting all dimensions"
    - "Both components use componentRadius from theme"
  artifacts:
    - path: "packages/registry/ui/textarea.tsx"
      provides: "Token-based Textarea with size prop"
      contains: "components.textarea"
    - path: "packages/registry/ui/select.tsx"
      provides: "Token-based Select with size prop"
      contains: "components.select"
  key_links:
    - from: "packages/registry/ui/textarea.tsx"
      to: "packages/core/src/theme/components.ts"
      via: "useTheme().components.textarea"
      pattern: "components\\.textarea\\[size\\]"
    - from: "packages/registry/ui/select.tsx"
      to: "packages/core/src/theme/components.ts"
      via: "useTheme().components.select"
      pattern: "components\\.select\\[size\\]"
---

<objective>
Refine Textarea and Select components to use centralized design tokens and support consistent size props.

Purpose: Both components currently use hardcoded values (fontSize: 14, minHeight: 48, etc.). Migrating to the token system ensures visual consistency and enables global theme customization.

Output: Token-based Textarea and Select components with sm/md/lg size variants.
</objective>

<execution_context>
@/Users/johanneschristler/.claude/get-shit-done/workflows/execute-plan.md
@/Users/johanneschristler/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/01-form-inputs/01-RESEARCH.md
@.planning/phases/01-form-inputs/01-01-SUMMARY.md

# Reference files
@packages/registry/ui/textarea.tsx
@packages/registry/ui/select.tsx
@packages/registry/ui/input.tsx (gold standard for token usage pattern)
@packages/core/src/theme/components.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate Textarea to token system</name>
  <files>packages/registry/ui/textarea.tsx</files>
  <action>
Refactor Textarea to use centralized tokens from components.textarea[size].

1. Add size prop to interface:
```typescript
export type TextareaSize = 'sm' | 'md' | 'lg';

export interface TextareaProps extends Omit<TextInputProps, 'style' | 'multiline'> {
  // ... existing props
  /** Size variant */
  size?: TextareaSize;
}
```

2. Update component to use tokens:
```typescript
export const Textarea = forwardRef<TextInput, TextareaProps>(
  ({
    size = 'md',  // Add default
    // ... other props
  }, ref) => {
    const { colors, components, componentRadius, timing, spacing } = useTheme();
    const tokens = components.textarea[size];
```

3. Replace hardcoded values with token references:

**Remove these hardcoded constants:**
- `const LINE_HEIGHT = 20;` - use `tokens.lineHeight`
- `const PADDING_VERTICAL = 12;` - use `tokens.paddingVertical`
- `const TIMING_CONFIG = ...` - use `timing.default`

**Replace in styles:**
- `fontSize: 14` -> `fontSize: tokens.fontSize`
- `paddingHorizontal: 12` -> `paddingHorizontal: tokens.paddingHorizontal`
- `paddingVertical: PADDING_VERTICAL` -> `paddingVertical: tokens.paddingVertical`
- `borderRadius: radius.md` -> `borderRadius: componentRadius.textarea`
- `lineHeight: LINE_HEIGHT` -> `lineHeight: tokens.lineHeight`
- Label `fontSize: 14` -> `fontSize: tokens.labelFontSize`
- Helper text `fontSize: 12` -> `fontSize: tokens.helperFontSize`

**Update height calculation:**
```typescript
const baseHeight = autoGrow
  ? height
  : rows * tokens.lineHeight + tokens.paddingVertical * 2;
```

4. Update autoGrow height constraints to use tokens:
```typescript
const minHeight = minRows * tokens.lineHeight + tokens.paddingVertical * 2;
const maxHeight = maxRows * tokens.lineHeight + tokens.paddingVertical * 2;
```

5. Use timing.default for animations:
```typescript
focusProgress.value = withTiming(1, timing.default);
```

6. Keep existing animated border style pattern (already correct).
  </action>
  <verify>TypeScript compilation: `cd packages/registry && npx tsc --noEmit`</verify>
  <done>Textarea uses components.textarea[size] tokens, supports sm/md/lg size prop</done>
</task>

<task type="auto">
  <name>Task 2: Migrate Select to token system</name>
  <files>packages/registry/ui/select.tsx</files>
  <action>
Refactor Select to use centralized tokens from components.select[size].

1. Add size prop to interface:
```typescript
export type SelectSize = 'sm' | 'md' | 'lg';

export interface SelectProps {
  // ... existing props
  /** Size variant */
  size?: SelectSize;
}
```

2. Update component to use tokens:
```typescript
export function Select({
  size = 'md',  // Add default
  // ... other props
}: SelectProps) {
  const { colors, components, componentRadius, timing, spacing } = useTheme();
  const tokens = components.select[size];
```

3. Replace hardcoded values with token references:

**Remove these:**
- `const TIMING_CONFIG = ...` - use `timing.default`

**Replace in styles:**
- Trigger `minHeight: 48` -> `minHeight: tokens.height`
- Trigger `paddingHorizontal: 12` -> `paddingHorizontal: tokens.paddingHorizontal`
- Trigger `borderRadius: radius.md` -> `borderRadius: componentRadius.select`
- Trigger text `fontSize: 14` -> implicit (remove, or add to tokens)
- Label `fontSize: 14` -> `fontSize: tokens.labelFontSize`
- Helper text `fontSize: 12` -> `fontSize: tokens.helperFontSize`
- Chevron `fontSize: 10` -> keep as is (chevron size is consistent)

**Add triggerText fontSize from tokens:**
```typescript
<Text
  style={[
    styles.triggerText,
    {
      fontSize: tokens.fontSize,
      color: selectedOption
        ? disabled
          ? colors.foregroundMuted
          : colors.foreground
        : colors.foregroundMuted,
    },
  ]}
  numberOfLines={1}
>
```

4. Use timing.default for animations:
```typescript
focusProgress.value = withTiming(1, timing.default);
```

5. Update option item styles to use spacing tokens:
```typescript
paddingVertical: spacing[size === 'sm' ? 2 : size === 'lg' ? 4 : 3],
paddingHorizontal: spacing[4],
```

6. Keep existing animated border style pattern (already correct).
  </action>
  <verify>TypeScript compilation: `cd packages/registry && npx tsc --noEmit`</verify>
  <done>Select uses components.select[size] tokens, supports sm/md/lg size prop</done>
</task>

</tasks>

<verification>
1. `cd packages/registry && npx tsc --noEmit` - TypeScript compiles without errors
2. No hardcoded numeric values remain for dimensions, font sizes, padding
3. Both components destructure `components` from useTheme and use `components.textarea[size]` / `components.select[size]`
</verification>

<success_criteria>
- Textarea imports and uses components.textarea[size] tokens
- Textarea supports size='sm' | 'md' | 'lg' prop with correct dimensions
- Select imports and uses components.select[size] tokens
- Select supports size='sm' | 'md' | 'lg' prop with correct dimensions
- No hardcoded fontSize, padding, height values remain (except for small UI elements like chevron)
- TypeScript compilation succeeds
</success_criteria>

<output>
After completion, create `.planning/phases/01-form-inputs/01-02-SUMMARY.md`
</output>
