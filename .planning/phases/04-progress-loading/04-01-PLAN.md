---
phase: 04-progress-loading
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - packages/core/src/theme/components.ts
  - packages/core/src/constants.ts
autonomous: true

must_haves:
  truths:
    - "All progress component size tokens are centralized in components.ts"
    - "Components can import spinner, skeleton, progress, circularProgress tokens"
    - "Token values match existing component implementations"
  artifacts:
    - path: "packages/core/src/theme/components.ts"
      provides: "spinnerTokens, skeletonTokens, progressTokens, circularProgressTokens"
      contains: "spinnerTokens"
    - path: "packages/core/src/constants.ts"
      provides: "PROGRESS_CONSTANTS, SKELETON_CONSTANTS"
      contains: "PROGRESS_CONSTANTS"
  key_links:
    - from: "packages/core/src/theme/components.ts"
      to: "components export object"
      via: "components.spinner, components.skeleton, etc."
      pattern: "spinner:\\s*spinnerTokens"
---

<objective>
Add centralized component tokens for all progress and loading components (Spinner, Skeleton, Progress, CircularProgress) to the core theme system.

Purpose: Establish the token foundation so all progress components can consume centralized values instead of hardcoded magic numbers, enabling consistent sizing and theme integration.

Output: Token definitions in components.ts and animation constants in constants.ts
</objective>

<execution_context>
@/Users/johanneschristler/.claude/get-shit-done/workflows/execute-plan.md
@/Users/johanneschristler/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/04-progress-loading/04-RESEARCH.md
@packages/core/src/theme/components.ts
@packages/core/src/constants.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add Spinner, Skeleton, Progress, CircularProgress tokens to components.ts</name>
  <files>packages/core/src/theme/components.ts</files>
  <action>
Add the following token definitions to components.ts, following the established pattern (see inputTokens, buttonTokens as reference):

1. **spinnerTokens** - Size mappings for ActivityIndicator wrapper:
```typescript
export const spinnerTokens = {
  sm: {
    containerSize: 16,
    indicatorSize: 'small' as const,
  },
  md: {
    containerSize: 24,
    indicatorSize: 'small' as const,
  },
  lg: {
    containerSize: 36,
    indicatorSize: 'large' as const,
  },
} as const;
```

2. **skeletonTokens** - Radius mappings and animation timing:
```typescript
export const skeletonTokens = {
  radius: {
    none: 0,
    sm: 4,
    md: 8,
    lg: 12,
    full: 9999,
  },
  animation: {
    duration: 1500,
    minOpacity: 0.3,
    maxOpacity: 0.6,
  },
  text: {
    defaultLines: 3,
    defaultGap: 8,
    defaultLineHeight: 16,
    lastLineWidth: '60%',
  },
} as const;
```

3. **progressTokens** - Height per size variant:
```typescript
export const progressTokens = {
  sm: {
    height: 4,
  },
  md: {
    height: 8,
  },
  lg: {
    height: 12,
  },
  animation: {
    determinateDuration: 300,
    indeterminateDuration: 1000,
  },
} as const;
```

4. **circularProgressTokens** - Size variants with stroke and label:
```typescript
export const circularProgressTokens = {
  sm: {
    size: 40,
    strokeWidth: 4,
    labelSize: 10,
  },
  md: {
    size: 64,
    strokeWidth: 6,
    labelSize: 14,
  },
  lg: {
    size: 96,
    strokeWidth: 8,
    labelSize: 20,
  },
  animation: {
    rotationDuration: 1200,
    springDamping: 20,
    springStiffness: 100,
  },
} as const;
```

Add all four to the `components` export object at the bottom:
```typescript
export const components = {
  // ... existing entries ...
  spinner: spinnerTokens,
  skeleton: skeletonTokens,
  progress: progressTokens,
  circularProgress: circularProgressTokens,
} as const;
```
  </action>
  <verify>
Run `npx tsc --noEmit` in packages/core and verify no TypeScript errors.
Grep for "spinnerTokens" in components.ts to confirm export exists.
  </verify>
  <done>
All four token objects (spinnerTokens, skeletonTokens, progressTokens, circularProgressTokens) exist in components.ts and are included in the components export object.
  </done>
</task>

<task type="auto">
  <name>Task 2: Add PROGRESS_CONSTANTS and SKELETON_CONSTANTS to constants.ts</name>
  <files>packages/core/src/constants.ts</files>
  <action>
Add animation and behavior constants for progress components to constants.ts:

1. **PROGRESS_CONSTANTS** - For determinate/indeterminate animation behavior:
```typescript
// ============================================
// Progress Constants
// ============================================

export const PROGRESS_CONSTANTS = {
  /** Indeterminate bar width as percentage */
  indeterminateWidth: 30,
  /** Fallback colors for success/warning variants */
  fallbackColors: {
    success: '#22c55e',
    warning: '#f59e0b',
  },
} as const;
```

2. **SKELETON_CONSTANTS** - For shimmer animation:
```typescript
// ============================================
// Skeleton Constants
// ============================================

export const SKELETON_CONSTANTS = {
  /** Default shimmer cycle duration (ms) */
  shimmerDuration: 1500,
  /** Opacity range for shimmer effect */
  opacityMin: 0.3,
  opacityMax: 0.6,
} as const;
```

3. Add type exports at the bottom:
```typescript
export type ProgressConstants = typeof PROGRESS_CONSTANTS;
export type SkeletonConstants = typeof SKELETON_CONSTANTS;
```
  </action>
  <verify>
Run `npx tsc --noEmit` in packages/core and verify no TypeScript errors.
Grep for "PROGRESS_CONSTANTS" and "SKELETON_CONSTANTS" to confirm exports.
  </verify>
  <done>
PROGRESS_CONSTANTS and SKELETON_CONSTANTS exist in constants.ts with proper type exports.
  </done>
</task>

</tasks>

<verification>
1. TypeScript compilation passes: `cd packages/core && npx tsc --noEmit`
2. All token exports visible: grep for spinnerTokens, skeletonTokens, progressTokens, circularProgressTokens in components.ts
3. All constant exports visible: grep for PROGRESS_CONSTANTS, SKELETON_CONSTANTS in constants.ts
4. Tokens accessible via import: verify `components.spinner`, `components.skeleton`, etc. exist
</verification>

<success_criteria>
- spinnerTokens with sm/md/lg container and indicator sizes
- skeletonTokens with radius map and animation settings
- progressTokens with sm/md/lg heights and animation durations
- circularProgressTokens with sm/md/lg size configs and animation settings
- PROGRESS_CONSTANTS with indeterminate width and fallback colors
- SKELETON_CONSTANTS with shimmer animation settings
- All exports properly typed and accessible from @metacells/mcellui-core
</success_criteria>

<output>
After completion, create `.planning/phases/04-progress-loading/04-01-SUMMARY.md`
</output>
