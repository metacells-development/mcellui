---
phase: 19-critical-color-api-fixes
plan: 04
type: execute
wave: 1
depends_on: []
files_modified:
  - packages/registry/screens/home-screen.tsx
  - packages/registry/screens/settings-screen.tsx
  - packages/registry/screens/comments-screen.tsx
  - packages/registry/screens/help-screen.tsx
  - packages/registry/screens/chat-screen.tsx
  - packages/registry/screens/account-screen.tsx
  - packages/registry/screens/followers-screen.tsx
  - packages/registry/screens/order-history-screen.tsx
  - packages/registry/screens/feed-screen.tsx
  - packages/registry/screens/otp-verification-screen.tsx
  - packages/registry/screens/profile-screen.tsx
  - packages/registry/screens/notifications-screen.tsx
  - packages/registry/screens/checkout-screen.tsx
  - packages/registry/screens/cart-screen.tsx
  - packages/registry/screens/product-detail-screen.tsx
  - packages/registry/screens/search-screen.tsx
  - packages/registry/screens/login-screen.tsx
  - packages/registry/screens/signup-screen.tsx
autonomous: true

must_haves:
  truths:
    - "All icon defaults in screen files use colors.foreground instead of #000"
    - "All hardcoded hex text colors in screens use semantic tokens"
    - "Login/signup Google logo colors (#4285F4, #34A853, #FBBC05, #EA4335) remain unchanged"
    - "Profile screen verified badge uses colors.primary instead of #3B82F6"
    - "Home screen notification badge uses semantic token instead of #fff"
  artifacts:
    - path: "packages/registry/screens/home-screen.tsx"
      provides: "Semantic icon and text colors"
      contains: "colors.foreground"
    - path: "packages/registry/screens/profile-screen.tsx"
      provides: "Semantic verified badge color"
      contains: "colors.primary"
    - path: "packages/registry/screens/login-screen.tsx"
      provides: "Google logo colors preserved"
      contains: "#4285F4"
  key_links:
    - from: "packages/registry/screens/*.tsx"
      to: "@metacells/mcellui-core"
      via: "useTheme() hook"
      pattern: "const \\{ colors \\} = useTheme"
---

<objective>
Fix all hardcoded colors (icon defaults, hex values) in screen components.

Purpose: Screen templates are the highest-level copy-paste templates. Users copy entire screens, so they must have perfect theming. Icons invisible in dark mode and hardcoded text colors are the most user-visible bugs.

Output: 18 screen files with all hardcoded colors replaced by semantic tokens (except intentional brand colors).
</objective>

<execution_context>
@/Users/johanneschristler/.claude/get-shit-done/workflows/execute-plan.md
@/Users/johanneschristler/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/19-critical-color-api-fixes/19-RESEARCH.md

Key reference:
@packages/core/src/theme/colors.ts (semantic color tokens)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix icon defaults and hex colors in screens (Part A: 9 screens)</name>
  <files>
    packages/registry/screens/home-screen.tsx
    packages/registry/screens/settings-screen.tsx
    packages/registry/screens/comments-screen.tsx
    packages/registry/screens/help-screen.tsx
    packages/registry/screens/chat-screen.tsx
    packages/registry/screens/account-screen.tsx
    packages/registry/screens/followers-screen.tsx
    packages/registry/screens/order-history-screen.tsx
    packages/registry/screens/feed-screen.tsx
  </files>
  <action>
For EACH of these 9 screen files, apply two categories of fixes:

**A) Icon defaults (#000 → colors.foreground):**
Find all inline icon function components with `color = '#000'` default and replace with `colors.foreground`.

Pattern (same as UI/blocks):
```tsx
// BEFORE
function BellIcon({ size = 24, color = '#000' }: { size?: number; color?: string }) {
// AFTER
function BellIcon({ size = 24, color }: { size?: number; color?: string }) {
  const { colors } = useTheme();
  const finalColor = color ?? colors.foreground;
```

If the icon function is defined INSIDE a component that already calls `useTheme()`, access the parent's `colors` variable rather than calling `useTheme()` again. But if the icon is a standalone module-level function, it must call `useTheme()` itself.

**CRITICAL:** This fix MUST be applied to ALL icon defaults in login-screen.tsx and signup-screen.tsx — every `color = '#000'` must become `color ?? colors.foreground`. Only the Google logo SVG path fill colors are exempt from changes.

**B) Hardcoded hex text/element colors:**
- `#fff` or `#ffffff` → `colors.primaryForeground` (if on colored background) or `colors.background` (if it's a surface color)
- `#000` → `colors.foreground`
- Any gray/muted color → `colors.foregroundMuted` or `colors.foregroundSubtle`

**Special case — home-screen.tsx (line ~419):**
- Replace `color: '#fff'` on notification badge text → `colors.destructiveForeground` (it's white text on a red badge, so `destructiveForeground` is semantically correct) OR `colors.primaryForeground` if the badge uses `colors.primary` background.
- Check what background color the badge uses to pick the right foreground token.

**Important:**
- home-screen.tsx has icons at lines ~48, ~56 — these are the most visible icons in the app
- Each screen may have 3-8 icon components. Process ALL of them.
  </action>
  <verify>
Run: `grep -rn "color = '#000'" packages/registry/screens/home-screen.tsx packages/registry/screens/settings-screen.tsx packages/registry/screens/comments-screen.tsx packages/registry/screens/help-screen.tsx packages/registry/screens/chat-screen.tsx packages/registry/screens/account-screen.tsx packages/registry/screens/followers-screen.tsx packages/registry/screens/order-history-screen.tsx packages/registry/screens/feed-screen.tsx`
Expected: Zero matches.

Run: `grep -n "'#fff'" packages/registry/screens/home-screen.tsx`
Expected: Zero matches.
  </verify>
  <done>All 9 screen files (Part A) use semantic color tokens for icons and text. No hardcoded #000/#fff values remain.</done>
</task>

<task type="auto">
  <name>Task 2: Fix icon defaults and hex colors in screens (Part B: 9 screens with brand exceptions)</name>
  <files>
    packages/registry/screens/otp-verification-screen.tsx
    packages/registry/screens/profile-screen.tsx
    packages/registry/screens/notifications-screen.tsx
    packages/registry/screens/checkout-screen.tsx
    packages/registry/screens/cart-screen.tsx
    packages/registry/screens/product-detail-screen.tsx
    packages/registry/screens/search-screen.tsx
    packages/registry/screens/login-screen.tsx
    packages/registry/screens/signup-screen.tsx
  </files>
  <action>
Same two categories of fixes as Task 1 (icon defaults + hex colors), but with IMPORTANT EXCEPTIONS:

**A) Icon defaults:** Same pattern — replace `color = '#000'` with `color ?? colors.foreground`.

**B) Hex color fixes — with exceptions:**

1. **profile-screen.tsx**: Replace `#3B82F6` (verified badge) → `colors.primary`. This is a blue badge that should match the user's theme primary color.

2. **login-screen.tsx — EXCEPTIONS:**
   - DO NOT change Google logo colors: `#4285F4`, `#34A853`, `#FBBC05`, `#EA4335`
   - These are official Google brand colors and must remain hardcoded
   - **CRITICAL:** DO fix all icon defaults (`color = '#000'` → `color ?? colors.foreground`) — icons use the icon default pattern, NOT the Google logo exception
   - DO change any other #fff/#000 text colors

3. **signup-screen.tsx — EXCEPTIONS:**
   - Same as login — DO NOT change Google logo colors
   - **CRITICAL:** DO fix all icon defaults (`color = '#000'` → `color ?? colors.foreground`)
   - DO change all other hardcoded colors

4. **All other files:** Apply standard replacement rules (same as Task 1).

**How to identify Google logo colors:**
Look for SVG path elements or View components that render the Google "G" logo. The colors will be near each other and form a group of 4 (#4285F4 blue, #34A853 green, #FBBC05 yellow, #EA4335 red). Leave that entire group untouched.
  </action>
  <verify>
Run: `grep -rn "color = '#000'" packages/registry/screens/otp-verification-screen.tsx packages/registry/screens/profile-screen.tsx packages/registry/screens/notifications-screen.tsx packages/registry/screens/checkout-screen.tsx packages/registry/screens/cart-screen.tsx packages/registry/screens/product-detail-screen.tsx packages/registry/screens/search-screen.tsx packages/registry/screens/login-screen.tsx packages/registry/screens/signup-screen.tsx`
Expected: Zero matches.

Run: `grep -n "'#3B82F6'" packages/registry/screens/profile-screen.tsx`
Expected: Zero matches (replaced with colors.primary).

Run: `grep -n "'#4285F4'" packages/registry/screens/login-screen.tsx`
Expected: At least 1 match (Google logo color preserved).

Run: `grep -n "'#4285F4'" packages/registry/screens/signup-screen.tsx`
Expected: At least 1 match (Google logo color preserved).
  </verify>
  <done>All 9 screen files (Part B) use semantic tokens. Google logo colors in login/signup are preserved. Profile verified badge uses colors.primary. No other hardcoded colors remain.</done>
</task>

</tasks>

<verification>
1. `grep -rn "color = '#000'" packages/registry/screens/` → 0 matches
2. `grep -rn "'#3B82F6'" packages/registry/screens/profile-screen.tsx` → 0 matches
3. `grep -rn "'#4285F4'" packages/registry/screens/login-screen.tsx packages/registry/screens/signup-screen.tsx` → 2+ matches (preserved Google colors)
4. `grep -rn "colors.foreground" packages/registry/screens/home-screen.tsx` → 2+ matches (icon defaults)
</verification>

<success_criteria>
- Zero `color = '#000'` icon defaults across all 18 screen files
- Zero hardcoded #fff/#000 text colors (except Google logo)
- Profile verified badge uses colors.primary
- Google logo colors (#4285F4, #34A853, #FBBC05, #EA4335) preserved in login + signup
- All screens use semantic tokens from useTheme()
</success_criteria>

<output>
After completion, create `.planning/phases/19-critical-color-api-fixes/19-04-SUMMARY.md`
</output>
