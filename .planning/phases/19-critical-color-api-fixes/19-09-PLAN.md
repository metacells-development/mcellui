---
phase: 19-critical-color-api-fixes
plan: 09
type: execute
wave: 1
depends_on: []
files_modified:
  - packages/registry/ui/card.tsx
  - packages/registry/ui/avatar-stack.tsx
  - packages/registry/ui/swipeable-row.tsx
  - packages/registry/blocks/profile-block.tsx
  - packages/registry/screens/profile-screen.tsx
  - packages/registry/screens/account-screen.tsx
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "All hardcoded #fff/#ffffff colors use semantic tokens (colors.primaryForeground or colors.background)"
    - "Avatar usages use valid size prop (sm|md|lg) instead of invalid 'xl'"
  artifacts:
    - path: "packages/registry/ui/card.tsx"
      provides: "Theme-aware ImageCard text"
      contains: "colors.primaryForeground"
    - path: "packages/registry/ui/avatar-stack.tsx"
      provides: "Theme-aware overflow text and background"
      contains: "colors.primaryForeground"
    - path: "packages/registry/ui/swipeable-row.tsx"
      provides: "Theme-aware action text default"
      contains: "colors.primaryForeground"
    - path: "packages/registry/blocks/profile-block.tsx"
      provides: "Valid Avatar size"
      contains: 'size="lg"'
    - path: "packages/registry/screens/profile-screen.tsx"
      provides: "Valid Avatar size"
      contains: 'size="lg"'
    - path: "packages/registry/screens/account-screen.tsx"
      provides: "Valid Avatar size"
      contains: 'size="lg"'
  key_links:
    - from: "text/background colors"
      to: "useTheme()"
      via: "semantic color tokens"
      pattern: "colors\\.(primaryForeground|background)"
---

<objective>
Fix hardcoded hex colors in UI components and invalid Avatar size usages in blocks/screens.

Purpose: Gaps from VERIFICATION.md show 3 UI components use #fff/#ffffff instead of semantic tokens, and 3 blocks/screens use invalid size="xl" on Avatar.

Output: 6 files with theme-aware colors and valid API usage.
</objective>

<execution_context>
@/Users/johanneschristler/.claude/get-shit-done/workflows/execute-plan.md
@/Users/johanneschristler/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/19-critical-color-api-fixes/19-VERIFICATION.md

# Reference implementation (correct patterns)
@packages/mcp-server/registry/ui/card.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix hex colors in card.tsx, avatar-stack.tsx, swipeable-row.tsx</name>
  <files>
    packages/registry/ui/card.tsx
    packages/registry/ui/avatar-stack.tsx
    packages/registry/ui/swipeable-row.tsx
  </files>
  <action>
**card.tsx** (line 403):
BEFORE:
```tsx
<Text style={[styles.imageCardTitle, { color: '#ffffff' }]}>
```
AFTER:
```tsx
<Text style={[styles.imageCardTitle, { color: colors.primaryForeground }]}>
```

Also check for subtitle (similar pattern around line 408-410).

**avatar-stack.tsx** (lines 175, 235):
Line 175 - overflow text color:
BEFORE: `color: '#ffffff'`
AFTER: `color: colors.primaryForeground`

Line 235 - overflow background:
BEFORE: `backgroundColor: '#ffffff'`
AFTER: `backgroundColor: colors.background`

Ensure colors is destructured from useTheme() in the component.

**swipeable-row.tsx** (line 334):
BEFORE:
```tsx
{ color: action.textColor ?? '#fff' },
```
AFTER:
```tsx
{ color: action.textColor ?? colors.primaryForeground },
```

Ensure colors is destructured from useTheme() in the component.
  </action>
  <verify>
Run: `grep -n "#fff\|#ffffff" packages/registry/ui/card.tsx packages/registry/ui/avatar-stack.tsx packages/registry/ui/swipeable-row.tsx`
Expected: No matches (or only in comments/documentation)

Run: `grep -n "colors.primaryForeground" packages/registry/ui/card.tsx packages/registry/ui/avatar-stack.tsx packages/registry/ui/swipeable-row.tsx`
Expected: At least 1 match per file
  </verify>
  <done>card.tsx, avatar-stack.tsx, swipeable-row.tsx use semantic color tokens instead of #fff</done>
</task>

<task type="auto">
  <name>Task 2: Fix Avatar size="xl" usages</name>
  <files>
    packages/registry/blocks/profile-block.tsx
    packages/registry/screens/profile-screen.tsx
    packages/registry/screens/account-screen.tsx
  </files>
  <action>
Simple find/replace in each file:

**profile-block.tsx** (line 108):
BEFORE: `size="xl"`
AFTER: `size="lg"`

**profile-screen.tsx** (line 226):
BEFORE: `size="xl"`
AFTER: `size="lg"`

**account-screen.tsx** (line 257):
BEFORE: `size="xl"`
AFTER: `size="lg"`

Note: Avatar type was updated in plan 19-05 to only accept 'sm' | 'md' | 'lg'. These usages of 'xl' are now type errors.
  </action>
  <verify>
Run: `grep -rn 'size="xl"' packages/registry/blocks/profile-block.tsx packages/registry/screens/profile-screen.tsx packages/registry/screens/account-screen.tsx`
Expected: No matches

Run: `grep -rn 'size="lg"' packages/registry/blocks/profile-block.tsx packages/registry/screens/profile-screen.tsx packages/registry/screens/account-screen.tsx`
Expected: At least 1 match per file
  </verify>
  <done>All Avatar usages use valid size="lg" instead of invalid size="xl"</done>
</task>

</tasks>

<verification>
```bash
# Verify no hardcoded hex colors remain
grep -rn "#fff" packages/registry/ui/card.tsx packages/registry/ui/avatar-stack.tsx packages/registry/ui/swipeable-row.tsx
# Expected: empty

# Verify semantic tokens used
grep -c "colors.primaryForeground\|colors.background" packages/registry/ui/card.tsx packages/registry/ui/avatar-stack.tsx packages/registry/ui/swipeable-row.tsx
# Expected: counts > 0 for each file

# Verify no invalid Avatar sizes
grep -rn 'size="xl"' packages/registry/blocks packages/registry/screens
# Expected: empty

# TypeScript check
cd packages/registry && npx tsc --noEmit
# Expected: no errors in modified files
```
</verification>

<success_criteria>
1. grep for `#fff` in card.tsx, avatar-stack.tsx, swipeable-row.tsx returns empty
2. grep for `colors.primaryForeground` shows usage in all 3 UI files
3. grep for `size="xl"` in blocks and screens returns empty
4. TypeScript compiles without errors
</success_criteria>

<output>
After completion, create `.planning/phases/19-critical-color-api-fixes/19-09-SUMMARY.md`
</output>
