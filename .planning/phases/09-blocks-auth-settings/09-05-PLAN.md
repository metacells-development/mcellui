---
phase: 09-blocks-auth-settings
plan: 05
type: execute
wave: 3
depends_on: ["09-02", "09-03", "09-04"]
files_modified:
  - apps/demo/components/demos/blocks-demo.tsx
autonomous: false

must_haves:
  truths:
    - "Demo shows all 6 blocks with complete state coverage (loading, error, disabled)"
    - "Demo shows auth blocks with form validation errors"
    - "Demo shows settings block with all item types (switch, navigation, button)"
    - "Demo shows state blocks in both compact and default variants"
  artifacts:
    - path: "apps/demo/components/demos/blocks-demo.tsx"
      provides: "Comprehensive block demos with all states"
      contains: "LoginBlockPreview"
  key_links:
    - from: "apps/demo/components/demos/blocks-demo.tsx"
      to: "packages/registry/blocks/*"
      via: "import block components"
      pattern: "import.*Block.*from"
---

<objective>
Enhance the blocks demo to show comprehensive state coverage for all Phase 9 blocks, including loading states, validation errors, and all interaction patterns.

Purpose: Demonstrate that all auth and settings blocks support the complete lifecycle of states (empty, loading, error, success) as required by the phase success criteria.

Output: Updated blocks-demo.tsx with enhanced previews showing all states and interaction patterns
</objective>

<execution_context>
@/Users/johanneschristler/.claude/get-shit-done/workflows/execute-plan.md
@/Users/johanneschristler/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/09-blocks-auth-settings/09-02-SUMMARY.md
@.planning/phases/09-blocks-auth-settings/09-03-SUMMARY.md
@.planning/phases/09-blocks-auth-settings/09-04-SUMMARY.md
@apps/demo/components/demos/blocks-demo.tsx
@packages/registry/blocks/login-block.tsx
@packages/registry/blocks/settings-list-block.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Enhance auth block demos with loading and validation states</name>
  <files>apps/demo/components/demos/blocks-demo.tsx</files>
  <action>
Update LoginBlockPreview and SignupBlockPreview to demonstrate:
1. Loading state during form submission
2. Validation error display
3. Social login buttons

**LoginBlockPreview enhancements:**
- Add a "Show Loading" toggle button that sets loading={true} to demonstrate async submission
- Show form validation by pre-populating with invalid data and triggering submit
- Use the actual LoginBlock component from registry instead of the inline mock

Replace the current inline LoginBlockPreview with one that uses the actual LoginBlock:

```typescript
function LoginBlockPreview() {
  const { colors, spacing } = useTheme();
  const [loading, setLoading] = useState(false);

  const handleSubmit = async (data: any) => {
    setLoading(true);
    // Simulate API call
    await new Promise((r) => setTimeout(r, 2000));
    setLoading(false);
    Alert.alert('Login Success', `Email: ${data.email}`);
  };

  return (
    <View style={{ gap: spacing[4] }}>
      {/* Loading state demo */}
      <Card>
        <CardHeader>
          <CardTitle>Loading State</CardTitle>
          <CardDescription>Shows spinner during form submission</CardDescription>
        </CardHeader>
        <CardContent>
          <LoginBlock
            onSubmit={handleSubmit}
            loading={loading}
            onForgotPassword={() => Alert.alert('Forgot Password')}
            onSignUp={() => Alert.alert('Sign Up')}
            showSocialLogin={true}
            socialProviders={['google', 'apple']}
          />
        </CardContent>
      </Card>
    </View>
  );
}
```

**SignupBlockPreview enhancements:**
- Similar loading state demonstration
- Show password validation hints appearing
- Use actual SignupBlock component

```typescript
function SignupBlockPreview() {
  const { colors, spacing } = useTheme();
  const [loading, setLoading] = useState(false);

  const handleSubmit = async (data: any) => {
    setLoading(true);
    await new Promise((r) => setTimeout(r, 2000));
    setLoading(false);
    Alert.alert('Signup Success', `Welcome ${data.name}!`);
  };

  return (
    <Card>
      <CardContent style={{ paddingTop: spacing[4] }}>
        <SignupBlock
          onSubmit={handleSubmit}
          loading={loading}
          onLogin={() => Alert.alert('Login')}
          onTermsPress={() => Alert.alert('Terms')}
          onPrivacyPress={() => Alert.alert('Privacy')}
        />
      </CardContent>
    </Card>
  );
}
```

Import the actual blocks at the top:
```typescript
import { LoginBlock } from '@/components/blocks/login-block';
import { SignupBlock } from '@/components/blocks/signup-block';
```
  </action>
  <verify>
Run the demo app and navigate to Blocks section.
Verify LoginBlock shows loading spinner when submitted.
Verify SignupBlock shows loading spinner when submitted.
Verify form validation works (try empty email).
  </verify>
  <done>
Auth block demos use actual LoginBlock/SignupBlock components and demonstrate loading states during form submission.
  </done>
</task>

<task type="auto">
  <name>Task 2: Enhance settings and state block demos with all variants</name>
  <files>apps/demo/components/demos/blocks-demo.tsx</files>
  <action>
Update SettingsListBlockPreview, EmptyStateBlockPreview, and ErrorStateBlockPreview.

**SettingsListBlockPreview enhancements:**
Use the actual SettingsListBlock component to show all item types:

```typescript
function SettingsListBlockPreview() {
  const { colors, spacing } = useTheme();
  const [notifications, setNotifications] = useState(true);
  const [darkMode, setDarkMode] = useState(false);

  return (
    <Card>
      <CardContent style={{ paddingTop: spacing[4] }}>
        <SettingsListBlock
          groups={[
            {
              title: 'PREFERENCES',
              items: [
                {
                  type: 'switch',
                  label: 'Push Notifications',
                  description: 'Receive alerts about activity',
                  value: notifications,
                  onValueChange: setNotifications,
                },
                {
                  type: 'switch',
                  label: 'Dark Mode',
                  value: darkMode,
                  onValueChange: setDarkMode,
                },
              ],
            },
            {
              title: 'ACCOUNT',
              description: 'Manage your account settings',
              items: [
                {
                  type: 'navigation',
                  label: 'Email',
                  displayValue: 'john@example.com',
                  onPress: () => Alert.alert('Edit Email'),
                },
                {
                  type: 'navigation',
                  label: 'Change Password',
                  onPress: () => Alert.alert('Change Password'),
                },
                {
                  type: 'button',
                  label: 'Log Out',
                  variant: 'destructive',
                  onPress: () => Alert.alert('Logout'),
                },
              ],
            },
          ]}
        />
      </CardContent>
    </Card>
  );
}
```

Import SettingsListBlock:
```typescript
import { SettingsListBlock } from '@/components/blocks/settings-list-block';
```

**EmptyStateBlockPreview enhancements:**
Show both default and compact variants:

```typescript
function EmptyStateBlockPreview() {
  const { colors, spacing } = useTheme();

  return (
    <View style={{ gap: spacing[4] }}>
      {/* Default variant */}
      <Card>
        <CardHeader>
          <CardTitle>Default</CardTitle>
        </CardHeader>
        <CardContent>
          <EmptyStateBlock
            icon={/* message icon SVG */}
            title="No messages"
            description="You don't have any messages yet. Start a conversation!"
            actionText="New Message"
            onAction={() => Alert.alert('New Message')}
          />
        </CardContent>
      </Card>

      {/* Compact variant */}
      <Card>
        <CardHeader>
          <CardTitle>Compact</CardTitle>
        </CardHeader>
        <CardContent>
          <EmptyStateBlock
            title="No results"
            description="Try adjusting your search"
            compact
          />
        </CardContent>
      </Card>
    </View>
  );
}
```

Import EmptyStateBlock:
```typescript
import { EmptyStateBlock } from '@/components/blocks/empty-state-block';
```

**ErrorStateBlockPreview enhancements:**
Show error state with retry loading:

```typescript
function ErrorStateBlockPreview() {
  const { colors, spacing } = useTheme();
  const [loading, setLoading] = useState(false);

  const handleRetry = async () => {
    setLoading(true);
    await new Promise((r) => setTimeout(r, 1500));
    setLoading(false);
    Alert.alert('Retry Complete');
  };

  return (
    <View style={{ gap: spacing[4] }}>
      {/* With retry loading */}
      <Card>
        <CardHeader>
          <CardTitle>With Retry Loading</CardTitle>
        </CardHeader>
        <CardContent>
          <ErrorStateBlock
            title="Something went wrong"
            description="We couldn't load your data. Please try again."
            errorCode="ERROR_NETWORK_TIMEOUT"
            onRetry={handleRetry}
            retryLoading={loading}
            onCancel={() => Alert.alert('Cancel')}
            cancelText="Go Back"
          />
        </CardContent>
      </Card>

      {/* Compact variant */}
      <Card>
        <CardHeader>
          <CardTitle>Compact</CardTitle>
        </CardHeader>
        <CardContent>
          <ErrorStateBlock
            title="Failed to load"
            description="Check your connection"
            compact
            onRetry={() => Alert.alert('Retry')}
          />
        </CardContent>
      </Card>
    </View>
  );
}
```

Import ErrorStateBlock:
```typescript
import { ErrorStateBlock } from '@/components/blocks/error-state-block';
```
  </action>
  <verify>
Run the demo app and navigate to Blocks section.
Verify SettingsListBlock shows all three item types (switch, navigation, destructive button).
Verify EmptyStateBlock shows both default and compact variants.
Verify ErrorStateBlock retry button shows loading spinner when clicked.
  </verify>
  <done>
Settings and state block demos use actual components from registry and demonstrate all variants, item types, and loading states.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete block demos with comprehensive state coverage:
- LoginBlock with loading state during submission
- SignupBlock with loading state and validation
- SettingsListBlock with switch, navigation, and destructive button items
- EmptyStateBlock in default and compact variants
- ErrorStateBlock with retry loading state
  </what-built>
  <how-to-verify>
1. Run `cd apps/demo && npx expo start`
2. Navigate to Blocks demo section
3. Test LoginBlock: Submit form and verify loading spinner appears
4. Test SettingsListBlock: Toggle switches, verify they respond
5. Test ErrorStateBlock: Click Retry and verify loading spinner on button
6. Test EmptyStateBlock: Compare default and compact sizes
7. On iOS: Test with VoiceOver - verify all buttons are accessible
8. On Android: Test with TalkBack if available
  </how-to-verify>
  <resume-signal>Type "approved" if demos work correctly with all states, or describe any issues</resume-signal>
</task>

</tasks>

<verification>
1. Demo app runs without errors
2. All 6 blocks render in the Blocks demo section
3. Loading states work: LoginBlock, SignupBlock, ErrorStateBlock show spinners
4. Compact variants render smaller than default
5. SettingsListBlock shows all 3 item types correctly
6. VoiceOver/TalkBack can navigate all interactive elements
</verification>

<success_criteria>
- All auth blocks show loading state during form submission
- Form validation errors display correctly (try submitting with empty fields)
- SettingsListBlock shows switch toggle, navigation chevron, destructive button
- EmptyStateBlock shows distinct compact vs default sizing
- ErrorStateBlock retryLoading prop shows loading spinner on retry button
- Accessibility: All interactive elements reachable via screen reader
</success_criteria>

<output>
After completion, create `.planning/phases/09-blocks-auth-settings/09-05-SUMMARY.md`
</output>
