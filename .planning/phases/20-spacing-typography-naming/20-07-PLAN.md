---
phase: 20-spacing-typography-naming
plan: 07
type: execute
wave: 1
depends_on: []
files_modified:
  - packages/mcp-server/registry/ui/segmented-control.tsx
  - packages/mcp-server/registry/ui/action-sheet.tsx
  - packages/mcp-server/registry/ui/toggle.tsx
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "All padding/margin values use spacing[n] tokens — no raw number values in styles"
  artifacts:
    - path: "packages/mcp-server/registry/ui/segmented-control.tsx"
      provides: "Token-based paddingHorizontal in segment style"
      contains: "spacing[2]"
    - path: "packages/mcp-server/registry/ui/action-sheet.tsx"
      provides: "Token-based paddingVertical in handleContainer style"
      contains: "spacing[3]"
    - path: "packages/mcp-server/registry/ui/toggle.tsx"
      provides: "Token-based paddingHorizontal in SIZE_CONFIG"
      contains: "spacing[2]"
  key_links:
    - from: "packages/mcp-server/registry/ui/toggle.tsx"
      to: "@metacells/mcellui-core"
      via: "spacing destructured from useTheme()"
      pattern: "spacing.*useTheme"
---

<objective>
Close 5 remaining hardcoded spacing values across 3 registry UI components discovered after 20-06 gap closure.

Purpose: Complete TOK-06 requirement — all padding/margin values must use spacing[n] tokens so user-configurable spacing presets work globally.

Output: 3 updated component files with spacing tokens replacing hardcoded numeric padding values.

Components outside original Phase 20 scope:
- segmented-control.tsx: 1 hardcoded value (paddingHorizontal: 8)
- action-sheet.tsx: 1 hardcoded value (paddingVertical: 12)
- toggle.tsx: 3 hardcoded values (paddingHorizontal: 8, 12, 16 in SIZE_CONFIG)
</objective>

<execution_context>
@/Users/johanneschristler/.claude/get-shit-done/workflows/execute-plan.md
@/Users/johanneschristler/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/20-spacing-typography-naming/20-VERIFICATION.md
@.planning/phases/20-spacing-typography-naming/20-06-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate hardcoded paddingHorizontal in segmented-control and paddingVertical in action-sheet</name>
  <files>
    packages/mcp-server/registry/ui/segmented-control.tsx
    packages/mcp-server/registry/ui/action-sheet.tsx
  </files>
  <action>
    These 2 components have hardcoded padding values in StyleSheets that must become spacing tokens.

    **segmented-control.tsx:**
    - Line 78 already has `const { colors, components, componentRadius, fontWeight, platformShadow } = useTheme();`
    - ADD `spacing` to the destructure: `const { colors, components, componentRadius, fontWeight, platformShadow, spacing } = useTheme();`
    - Line 220 in StyleSheet: `paddingHorizontal: 8` in `segment` style
    - Since this is in a static StyleSheet, move `paddingHorizontal` to inline style
    - Line 171-177 applies `styles.segment` to Pressable, change to:
      ```tsx
      style={[
        styles.segment,
        {
          height: segmentHeight,
          paddingHorizontal: spacing[2],
          opacity: isSegmentDisabled ? 0.5 : 1,
        },
      ]}
      ```
    - Remove `paddingHorizontal: 8` from the StyleSheet `segment` object (line 220)

    **action-sheet.tsx:**
    - Line 104 already has `const { colors, spacing, components, componentRadius, radius } = useTheme();`
    - Line 374 in StyleSheet: `paddingVertical: 12` in `handleContainer` style
    - Move `paddingVertical` to inline style at line 192
    - Change `<View style={styles.handleContainer}>` to:
      ```tsx
      <View style={[styles.handleContainer, { paddingVertical: spacing[3] }]}>
      ```
    - Remove `paddingVertical: 12` from the StyleSheet `handleContainer` object (line 374)
  </action>
  <verify>
    Run: `grep -n "paddingHorizontal: 8" packages/mcp-server/registry/ui/segmented-control.tsx`
    Expected: No matches (0 results)

    Run: `grep -n "paddingVertical: 12" packages/mcp-server/registry/ui/action-sheet.tsx`
    Expected: No matches (0 results)

    Run: `grep -n "spacing\[2\]" packages/mcp-server/registry/ui/segmented-control.tsx`
    Expected: At least 1 match for paddingHorizontal

    Run: `grep -n "spacing\[3\]" packages/mcp-server/registry/ui/action-sheet.tsx`
    Expected: At least 1 match for paddingVertical
  </verify>
  <done>segmented-control paddingHorizontal uses spacing[2], action-sheet paddingVertical uses spacing[3]</done>
</task>

<task type="auto">
  <name>Task 2: Migrate hardcoded paddingHorizontal in toggle SIZE_CONFIG</name>
  <files>
    packages/mcp-server/registry/ui/toggle.tsx
  </files>
  <action>
    The toggle.tsx component has a static SIZE_CONFIG object with hardcoded paddingHorizontal values (8, 12, 16) for sm, md, lg sizes. Since SIZE_CONFIG is module-level (static), we cannot directly use spacing tokens there. However, the values are accessed at runtime via `config.paddingHorizontal` where theme is available.

    **Solution:** Remove paddingHorizontal from SIZE_CONFIG and compute it from spacing tokens at runtime.

    **toggle.tsx:**

    1. Line 41: Add `spacing` to imports from mcellui-core (already imports fontSize, fontWeight):
       `import { useTheme, fontSize, fontWeight, spacing } from '@metacells/mcellui-core';`

    2. Lines 106-128: Remove `paddingHorizontal` from SIZE_CONFIG entirely:
       ```tsx
       const SIZE_CONFIG = {
         sm: {
           height: 32,
           minWidth: 32,
           fontSize: fontSize.xs,
           iconSize: 16,
         },
         md: {
           height: 40,
           minWidth: 40,
           fontSize: fontSize.sm,
           iconSize: 18,
         },
         lg: {
           height: 48,
           minWidth: 48,
           fontSize: fontSize.base,
           iconSize: 20,
         },
       };
       ```

    3. Create a helper to get spacing-based paddingHorizontal. Add after SIZE_CONFIG (around line 129):
       ```tsx
       const PADDING_CONFIG: Record<ToggleSize, keyof typeof spacing> = {
         sm: 2,    // spacing[2] = 8
         md: 3,    // spacing[3] = 12
         lg: 4,    // spacing[4] = 16
       };
       ```

    4. In Toggle component (line 161), add spacing to useTheme destructure:
       `const { colors, radius, spacing } = useTheme();`

    5. Line 227: Change `paddingHorizontal: config.paddingHorizontal` to use spacing:
       `paddingHorizontal: spacing[PADDING_CONFIG[size]],`

    6. In ToggleGroupItem component (find it after Toggle), it also uses SIZE_CONFIG.
       Find where it applies paddingHorizontal and update similarly.
       The ToggleGroupItem gets size from context and should access spacing from useTheme.
       Add `spacing` to its useTheme destructure and update paddingHorizontal usage.
  </action>
  <verify>
    Run: `grep -n "paddingHorizontal: 8\|paddingHorizontal: 12\|paddingHorizontal: 16" packages/mcp-server/registry/ui/toggle.tsx`
    Expected: No matches (0 results)

    Run: `grep -n "PADDING_CONFIG" packages/mcp-server/registry/ui/toggle.tsx`
    Expected: At least 2 matches (definition + usage)

    Run: `grep -n "spacing\[PADDING_CONFIG" packages/mcp-server/registry/ui/toggle.tsx`
    Expected: At least 1 match for the Toggle component
  </verify>
  <done>toggle SIZE_CONFIG no longer has hardcoded padding; paddingHorizontal computed from spacing[2], spacing[3], spacing[4] at runtime via PADDING_CONFIG mapping</done>
</task>

</tasks>

<verification>
1. `grep -rn "paddingHorizontal: 8\|paddingHorizontal: 12\|paddingHorizontal: 16\|paddingVertical: 12" packages/mcp-server/registry/ui/segmented-control.tsx packages/mcp-server/registry/ui/action-sheet.tsx packages/mcp-server/registry/ui/toggle.tsx` returns 0 results
2. `grep -rn "spacing\[" packages/mcp-server/registry/ui/segmented-control.tsx packages/mcp-server/registry/ui/action-sheet.tsx packages/mcp-server/registry/ui/toggle.tsx` shows new spacing token usages
3. TypeScript compiles without errors: `npx tsc --noEmit -p packages/mcp-server/tsconfig.json`
</verification>

<success_criteria>
- All 5 hardcoded padding values replaced with spacing tokens
- segmented-control uses spacing[2] for paddingHorizontal
- action-sheet uses spacing[3] for paddingVertical
- toggle uses spacing[2/3/4] for sm/md/lg paddingHorizontal via PADDING_CONFIG
- No new TypeScript errors introduced
- TOK-06 verification passes (no raw padding numbers in registry/ui)
</success_criteria>

<output>
After completion, create `.planning/phases/20-spacing-typography-naming/20-07-SUMMARY.md`
</output>
