---
phase: 21-demo-consistency-validation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/demo/app/_layout.tsx
autonomous: true

must_haves:
  truths:
    - "Theme selector modal uses semantic color tokens"
    - "Theme selector adapts correctly to dark mode"
    - "Typography in _layout.tsx uses theme tokens"
  artifacts:
    - path: "apps/demo/app/_layout.tsx"
      provides: "Theme-aware layout and theme selector modal"
      contains: "colors.background"
  key_links:
    - from: "apps/demo/app/_layout.tsx"
      to: "useTheme()"
      via: "ThemeSelector component imports"
      pattern: "const \\{ colors.*\\} = useTheme"
---

<objective>
Migrate _layout.tsx theme selector modal from hardcoded colors to semantic tokens

Purpose: The theme selector modal currently uses hardcoded light-mode colors (#ffffff, #171717, #3b82f6, etc.) and will appear broken in dark mode. This is the most visible demo app issue and blocks proper dark mode testing of other screens.

Output: Theme selector modal that adapts to current color scheme using useTheme() tokens
</objective>

<execution_context>
@/Users/johanneschristler/.claude/get-shit-done/workflows/execute-plan.md
@/Users/johanneschristler/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/21-demo-consistency-validation/21-RESEARCH.md
@apps/demo/app/_layout.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate ThemeSelector colors to semantic tokens</name>
  <files>apps/demo/app/_layout.tsx</files>
  <action>
The ThemeSelector component (lines 13-109) renders outside ConfigProvider context. Move semantic token access INTO the component using useTheme().

Replace hardcoded colors in selectorStyles (lines 222-319):
- `#ffffff` -> `colors.background`
- `#171717` -> `colors.foreground`
- `#737373` -> `colors.foregroundMuted`
- `#3b82f6` -> `colors.primary`
- `#e5e5e5` -> `colors.border`
- `#f5f5f5` -> `colors.secondary`
- `#eff6ff` -> `colors.primaryMuted` (selected state background)
- `#525252` -> `colors.foregroundMuted`

Move color properties from StyleSheet to inline styles since theme tokens are dynamic:
```tsx
function ThemeSelector({ ... }) {
  const { colors, spacing, radius, fontSize, fontWeight } = useTheme();

  return (
    <SafeAreaView style={[selectorStyles.container, { backgroundColor: colors.background }]}>
      ...
    </SafeAreaView>
  );
}
```

IMPORTANT: The themeColors record (lines 31-40) showing color swatches for each theme MUST remain hardcoded - these are intentional preview colors, not UI chrome.
  </action>
  <verify>
grep -c "colors\." apps/demo/app/_layout.tsx should show 15+ uses of semantic tokens.
grep -E "#[0-9a-fA-F]{6}" apps/demo/app/_layout.tsx should show only themeColors swatches (8 colors for theme preview).
  </verify>
  <done>
ThemeSelector uses semantic color tokens for all UI chrome. Only theme preview swatches remain hardcoded.
  </done>
</task>

<task type="auto">
  <name>Task 2: Migrate _layout.tsx typography to tokens</name>
  <files>apps/demo/app/_layout.tsx</files>
  <action>
Replace hardcoded fontSize values with typography tokens:
- `fontSize: 20` -> `fontSize: fontSize.lg` (icon)
- `fontSize: 18` -> `fontSize: fontSize.lg` (title)
- `fontSize: 16` -> `fontSize: fontSize.md` (closeText)
- `fontSize: 14` -> `fontSize: fontSize.base` (sectionTitle)
- `fontSize: 12` -> `fontSize: fontSize.sm` (themeLabel, radiusLabel)

Replace hardcoded fontWeight values:
- `fontWeight: '600'` -> `fontWeight: fontWeight.semibold`
- `fontWeight: '500'` -> `fontWeight: fontWeight.medium`

Since typography tokens come from useTheme(), these need to be applied inline alongside color tokens.

Also migrate spacing values to tokens:
- `gap: 8` -> `gap: spacing[2]`
- `padding: 8` -> `padding: spacing[2]`
- `paddingHorizontal: 16` -> `paddingHorizontal: spacing[4]`
- `paddingVertical: 12` -> `paddingVertical: spacing[3]`
- `marginTop: 24` -> `marginTop: spacing[6]`
- `marginBottom: 12` -> `marginBottom: spacing[3]`
- `marginBottom: 8` -> `marginBottom: spacing[2]`
- `gap: 12` -> `gap: spacing[3]`
  </action>
  <verify>
grep -E "fontSize:\s*\d+" apps/demo/app/_layout.tsx should return 0 matches.
grep -E "fontWeight:\s*['\"]" apps/demo/app/_layout.tsx should return 0 matches.
  </verify>
  <done>
All typography and spacing in _layout.tsx uses theme tokens. No hardcoded numeric font or spacing values.
  </done>
</task>

</tasks>

<verification>
1. Run: `cd apps/demo && npx expo start` - app should launch without errors
2. Open theme selector modal - should display correctly in both light and dark mode
3. Toggle dark mode via header button - theme selector should adapt colors
4. Verify theme preview swatches still show correct brand colors
</verification>

<success_criteria>
- Theme selector modal adapts to dark/light mode
- All UI chrome uses semantic color tokens
- Typography uses theme tokens
- Theme preview swatches remain hardcoded (intentional)
- No visual regressions in light mode
</success_criteria>

<output>
After completion, create `.planning/phases/21-demo-consistency-validation/21-01-SUMMARY.md`
</output>
