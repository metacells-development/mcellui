---
phase: 06-layout-structure
plan: 02
type: execute
wave: 2
depends_on: ["06-01"]
files_modified:
  - packages/registry/ui/list.tsx
  - packages/registry/ui/section-header.tsx
autonomous: true

must_haves:
  truths:
    - "List divider inset uses LIST_CONSTANTS.dividerInset instead of hardcoded 56"
    - "List item minHeight uses componentHeight.lg instead of hardcoded 56"
    - "SectionHeader marginRight uses spacing[4] instead of hardcoded 16"
  artifacts:
    - path: "packages/registry/ui/list.tsx"
      provides: "List with token-based dimensions"
      contains: "LIST_CONSTANTS"
    - path: "packages/registry/ui/section-header.tsx"
      provides: "SectionHeader with token-based spacing"
      contains: "spacing[4]"
  key_links:
    - from: "packages/registry/ui/list.tsx"
      to: "packages/core/src/theme/components.ts"
      via: "LIST_CONSTANTS import"
      pattern: "LIST_CONSTANTS\\.dividerInset"
---

<objective>
Migrate List and SectionHeader to use centralized tokens

Purpose: Replace hardcoded values (56, 16) with token references to ensure consistent spacing across theme presets and easier maintenance.

Output: List and SectionHeader components using tokens instead of magic numbers
</objective>

<execution_context>
@/Users/johanneschristler/.claude/get-shit-done/workflows/execute-plan.md
@/Users/johanneschristler/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/06-layout-structure/06-RESEARCH.md
@.planning/phases/06-layout-structure/06-01-SUMMARY.md
@packages/registry/ui/list.tsx
@packages/registry/ui/section-header.tsx
@packages/core/src/theme/components.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate List component to use LIST_CONSTANTS</name>
  <files>packages/registry/ui/list.tsx</files>
  <action>
1. Add import for LIST_CONSTANTS:
```typescript
import { LIST_CONSTANTS, componentHeight } from '@metacells/mcellui-core';
```

2. Replace hardcoded divider inset (around line 186):
```typescript
// BEFORE
marginLeft: insetDividers ? 56 : 0,

// AFTER
marginLeft: insetDividers ? LIST_CONSTANTS.dividerInset : 0,
```

3. Replace hardcoded minHeight (around line 423):
```typescript
// BEFORE
minHeight: variant === 'thumbnail' ? thumbnailSize + spacing[3] * 2 : 56,

// AFTER
minHeight: variant === 'thumbnail' ? thumbnailSize + spacing[3] * 2 : componentHeight.lg,
```

Note: componentHeight.lg is 52px not 56px. The research identified this as a fix to use proper touch target guidelines. If visual regression is a concern, can use LIST_CONSTANTS.legacyMinHeight for exact backward compatibility.

Add comment above the divider marginLeft explaining the calculation:
```typescript
// Divider inset aligns with text content after icon slot
// = padding (16) + icon (24) + gap (12) + buffer (4) = 56px
```
  </action>
  <verify>
```bash
cd /Users/johanneschristler/Code/metacells/other/mcellui && npx tsc --noEmit -p packages/registry/tsconfig.json
grep -n "LIST_CONSTANTS\|componentHeight" packages/registry/ui/list.tsx
```
  </verify>
  <done>
List component uses LIST_CONSTANTS.dividerInset for divider margins and componentHeight.lg for item minHeight. No hardcoded 56 values remain except in LIST_CONSTANTS definition.
  </done>
</task>

<task type="auto">
  <name>Task 2: Migrate SectionHeader marginRight to spacing token</name>
  <files>packages/registry/ui/section-header.tsx</files>
  <action>
The hardcoded value is in the static StyleSheet at line 241:

```typescript
// BEFORE (in styles StyleSheet)
titleContainer: {
  flex: 1,
  marginRight: 16,
},

// AFTER - move to dynamic style
```

Since SectionHeader already uses useTheme() and applies spacing dynamically, convert the marginRight to use the spacing token:

Option A (preferred - dynamic in component):
In the component render, update the titleContainer style:
```typescript
<View style={[styles.titleContainer, { marginRight: spacing[4] }]}>
```

And remove marginRight from the StyleSheet:
```typescript
titleContainer: {
  flex: 1,
  // marginRight moved to dynamic style for token usage
},
```

Add a comment explaining the spacing:
```typescript
// marginRight: spacing[4] ensures consistent gap between title and action
```
  </action>
  <verify>
```bash
cd /Users/johanneschristler/Code/metacells/other/mcellui && npx tsc --noEmit -p packages/registry/tsconfig.json
grep -n "marginRight" packages/registry/ui/section-header.tsx
```
Should show marginRight only in dynamic style with spacing[4], not in static StyleSheet.
  </verify>
  <done>
SectionHeader uses spacing[4] for marginRight instead of hardcoded 16. TypeScript compiles without errors.
  </done>
</task>

</tasks>

<verification>
1. `grep "56" packages/registry/ui/list.tsx` returns no results (except imports)
2. `grep "marginRight: 16" packages/registry/ui/section-header.tsx` returns no results
3. Both components compile without errors
4. LIST_CONSTANTS is imported and used in list.tsx
</verification>

<success_criteria>
- List.tsx has zero hardcoded 56 values (only LIST_CONSTANTS references)
- SectionHeader.tsx uses spacing[4] for marginRight
- Both components type-check successfully
- Visual appearance unchanged (56px inset, 52px height)
</success_criteria>

<output>
After completion, create `.planning/phases/06-layout-structure/06-02-SUMMARY.md`
</output>
