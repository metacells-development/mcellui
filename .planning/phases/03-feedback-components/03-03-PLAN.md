---
phase: 03-feedback-components
plan: 03
type: execute
wave: 2
depends_on: ["03-01"]
files_modified:
  - packages/registry/ui/alert.tsx
autonomous: true

must_haves:
  truths:
    - "Alert uses ALERT_CONSTANTS for size tokens instead of internal sizeTokens"
    - "Alert maintains all existing functionality (variants, sizes, dismissible, hideIcon)"
    - "No hardcoded size values in Alert component"
  artifacts:
    - path: "packages/registry/ui/alert.tsx"
      provides: "Alert with centralized size tokens"
      contains: "ALERT_CONSTANTS"
  key_links:
    - from: "packages/registry/ui/alert.tsx"
      to: "@metacells/mcellui-core"
      via: "import"
      pattern: "import.*ALERT_CONSTANTS"
---

<objective>
Migrate Alert component to use centralized ALERT_CONSTANTS instead of internal hardcoded sizeTokens.

Purpose: Alert currently defines sizeTokens internally with hardcoded values. Moving these to ALERT_CONSTANTS centralizes the configuration and aligns with the pattern used by other components.

Output: Alert component using ALERT_CONSTANTS for all size-related values.
</objective>

<execution_context>
@/Users/johanneschristler/.claude/get-shit-done/workflows/execute-plan.md
@/Users/johanneschristler/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/03-feedback-components/03-01-SUMMARY.md

@packages/registry/ui/alert.tsx
@packages/core/src/constants.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate Alert to ALERT_CONSTANTS</name>
  <files>packages/registry/ui/alert.tsx</files>
  <action>
1. Add import for ALERT_CONSTANTS from @metacells/mcellui-core:
   ```typescript
   import { useTheme, ThemeColors, ALERT_CONSTANTS } from '@metacells/mcellui-core';
   ```

2. Remove the internal sizeTokens object (lines ~94-116):
   ```typescript
   // DELETE THIS:
   const sizeTokens = {
     sm: { padding: 12, iconSize: 16, ... },
     md: { padding: 16, iconSize: 20, ... },
     lg: { padding: 20, iconSize: 24, ... },
   };
   ```

3. Update the Alert function to use ALERT_CONSTANTS.sizes[size]:
   ```typescript
   const tokens = ALERT_CONSTANTS.sizes[size];
   ```

   The structure should be:
   - ALERT_CONSTANTS.sizes.sm.padding, .iconSize, .titleSize, .textSize, .gap
   - ALERT_CONSTANTS.sizes.md.padding, .iconSize, .titleSize, .textSize, .gap
   - ALERT_CONSTANTS.sizes.lg.padding, .iconSize, .titleSize, .textSize, .gap

4. Verify all references to `tokens.padding`, `tokens.iconSize`, `tokens.titleSize`, `tokens.textSize`, `tokens.gap` still work with the new structure.

5. The close button icon size uses `tokens.iconSize - 4`. This pattern should remain:
   ```typescript
   <CloseIcon color={variantStyles.iconColor} size={tokens.iconSize - 4} />
   ```

Note: If 03-01 defines ALERT_CONSTANTS differently (e.g., ALERT_CONSTANTS.sm instead of ALERT_CONSTANTS.sizes.sm), adapt accordingly. The key is to replace internal sizeTokens with the external constant.
  </action>
  <verify>
Run `npx tsc --noEmit -p packages/registry` - no type errors.
Grep to confirm removal: `grep "const sizeTokens" packages/registry/ui/alert.tsx` should return nothing.
Grep to confirm usage: `grep "ALERT_CONSTANTS" packages/registry/ui/alert.tsx` should return import and usage.
  </verify>
  <done>
Alert component uses ALERT_CONSTANTS instead of internal sizeTokens. All size variants (sm, md, lg) work correctly.
  </done>
</task>

<task type="auto">
  <name>Task 2: Verify Alert maintains full functionality</name>
  <files>packages/registry/ui/alert.tsx</files>
  <action>
After the migration, verify the component still supports all features by checking the code:

1. Variants: default, info, success, warning, destructive - getVariantStyles function unchanged
2. Sizes: sm, md, lg - now from ALERT_CONSTANTS
3. Title prop: renders title text with titleSize from tokens
4. Icon rendering: uses iconSize from tokens, supports custom icon, hideIcon
5. Dismissible: onClose prop shows close button
6. Accessibility: accessibilityRole="alert" present

If any functionality was accidentally broken during migration, fix it.

Also check that the styles object still uses correct token references:
- container: padding: tokens.padding, gap: tokens.gap
- title: fontSize: tokens.titleSize
- text: fontSize: tokens.textSize
- iconContainer: uses tokens.iconSize for icon rendering
  </action>
  <verify>
Manual code review confirms all features are intact.
`npx tsc --noEmit -p packages/registry` passes.
  </verify>
  <done>
Alert maintains all functionality: variants, sizes, title, icon customization, dismissible, accessibility.
  </done>
</task>

</tasks>

<verification>
After all tasks:
1. `npx tsc --noEmit -p packages/registry` passes
2. No internal sizeTokens in Alert
3. ALERT_CONSTANTS imported and used
4. All Alert features (variants, sizes, title, icons, dismiss) work
</verification>

<success_criteria>
- Alert imports ALERT_CONSTANTS from @metacells/mcellui-core
- Internal sizeTokens object removed
- All size variants (sm, md, lg) use ALERT_CONSTANTS
- Component functionality unchanged
- TypeScript compiles without errors
</success_criteria>

<output>
After completion, create `.planning/phases/03-feedback-components/03-03-SUMMARY.md`
</output>
