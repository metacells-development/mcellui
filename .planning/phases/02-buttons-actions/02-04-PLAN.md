---
phase: 02-buttons-actions
plan: 04
type: execute
wave: 2
depends_on: ["02-01"]
files_modified:
  - packages/registry/ui/segmented-control.tsx
autonomous: true

must_haves:
  truths:
    - "SegmentedControl uses centralized tokens from components.segmentedControl[size]"
    - "SegmentedControl uses componentRadius for container and indicator"
    - "SegmentedControl uses theme colors consistently"
  artifacts:
    - path: "packages/registry/ui/segmented-control.tsx"
      provides: "Token-based SegmentedControl component"
      contains: "components.segmentedControl"
  key_links:
    - from: "packages/registry/ui/segmented-control.tsx"
      to: "@metacells/mcellui-core"
      via: "import useTheme"
      pattern: "components.segmentedControl"
---

<objective>
Migrate SegmentedControl to use centralized tokens for consistent sizing and styling.

Purpose: Ensure SegmentedControl uses the same token-based approach as other components
Output: Refactored SegmentedControl using components.segmentedControl tokens, componentRadius
</objective>

<execution_context>
@/Users/johanneschristler/.claude/get-shit-done/workflows/execute-plan.md
@/Users/johanneschristler/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/02-buttons-actions/02-RESEARCH.md
@.planning/phases/02-buttons-actions/02-01-SUMMARY.md
@packages/registry/ui/segmented-control.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate SegmentedControl to use centralized tokens</name>
  <files>packages/registry/ui/segmented-control.tsx</files>
  <action>
Refactor SegmentedControl to use centralized tokens:

1. **Remove hardcoded heights and fontSizes** - Delete these objects (lines 67-77):
```typescript
// DELETE:
const heights: Record<SegmentedControlSize, number> = {
  sm: 32,
  md: 40,
  lg: 48,
};

const fontSizes: Record<SegmentedControlSize, number> = {
  sm: 13,
  md: 14,
  lg: 15,
};
```

2. **Update useTheme destructuring** - Include components and componentRadius:
```typescript
const { colors, components, componentRadius, fontWeight } = useTheme();
const tokens = components.segmentedControl[size];
```

3. **Update height and fontSize to use tokens**:
```typescript
// OLD:
const height = heights[size];
const fontSize = fontSizes[size];

// NEW:
const height = tokens.height;
const fontSize = tokens.fontSize;
```

4. **Update container style to use componentRadius**:
```typescript
style={[
  styles.container,
  {
    height,
    backgroundColor: colors.backgroundMuted,
    borderRadius: componentRadius.segmentedControl,  // Use token instead of radius.lg
    padding: tokens.padding,
    opacity: disabled ? 0.5 : 1,
  },
  style,
]}
```

5. **Update indicator style to use componentRadius**:
```typescript
style={[
  styles.indicator,
  {
    height: segmentHeight,
    backgroundColor: colors.background,
    borderRadius: componentRadius.segmentedControlIndicator,  // Use token instead of radius.md
  },
  indicatorStyle,
]}
```

6. **Update segment text font weight to use tokens**:
```typescript
<Text
  style={[
    styles.segmentText,
    {
      fontSize,
      color: isActive ? colors.foreground : colors.foregroundMuted,
      fontWeight: isActive ? tokens.activeFontWeight : tokens.fontWeight,  // Use tokens
    },
    textStyle,
  ]}
  numberOfLines={1}
>
  {segment.label}
</Text>
```

Note: fontWeight values are now strings from tokens (e.g., "500", "600") which matches Text style types.
  </action>
  <verify>
1. `npx tsc --noEmit -p packages/registry/tsconfig.json` passes
2. Start demo app and verify SegmentedControl demo works: all sizes render correctly, animation works, disabled states work
  </verify>
  <done>SegmentedControl uses centralized tokens from components.segmentedControl[size] and componentRadius</done>
</task>

</tasks>

<verification>
1. TypeScript compiles: `npx tsc --noEmit -p packages/registry/tsconfig.json`
2. Demo verification: SegmentedControl renders at all 3 sizes (sm, md, lg)
3. Animation verification: Indicator still animates smoothly between segments
4. Disabled verification: Both full disabled and individual segment disabled work
</verification>

<success_criteria>
- [ ] SegmentedControl uses components.segmentedControl[size] for tokens
- [ ] SegmentedControl uses componentRadius.segmentedControl for container
- [ ] SegmentedControl uses componentRadius.segmentedControlIndicator for indicator
- [ ] Local heights and fontSizes objects removed
- [ ] fontWeight uses tokens.fontWeight and tokens.activeFontWeight
- [ ] TypeScript compilation passes
- [ ] Visual output unchanged (same sizes, same visual appearance)
</success_criteria>

<output>
After completion, create `.planning/phases/02-buttons-actions/02-04-SUMMARY.md`
</output>
