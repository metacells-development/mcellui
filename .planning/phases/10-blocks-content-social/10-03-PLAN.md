# Plan 10-03: Social Blocks Interaction States

```yaml
phase: 10-blocks-content-social
plan: 03
type: execute
wave: 2
depends_on:
  - 10-01
files_modified:
  - packages/registry/blocks/feed-post-card.tsx
  - packages/registry/blocks/chat-bubble.tsx
  - packages/registry/blocks/comment-item.tsx
autonomous: true

must_haves:
  truths:
    - "FeedPostCard shows loading indicators on like/comment/share actions"
    - "ChatBubble supports disabled state for long press"
    - "CommentItem shows loading indicator on like action"
    - "All social blocks have accessibility labels on interactive elements"
  artifacts:
    - path: "packages/registry/blocks/feed-post-card.tsx"
      provides: "FeedPostCard with loading and disabled props"
      contains: "likeLoading"
    - path: "packages/registry/blocks/chat-bubble.tsx"
      provides: "ChatBubble with disabled prop"
      contains: "disabled"
    - path: "packages/registry/blocks/comment-item.tsx"
      provides: "CommentItem with likeLoading and disabled props"
      contains: "likeLoading"
  key_links:
    - from: "packages/registry/blocks/*-card.tsx"
      to: "packages/core/src/theme/components.ts"
      via: "import socialBlockTokens"
      pattern: "import.*socialBlockTokens"
```

<objective>
Add comprehensive interactive states (loading, disabled) to social blocks and migrate to socialBlockTokens for consistent styling.

Purpose: Ensure social blocks support loading indicators, disabled states, and accessibility labels for all interactive elements.
Output: FeedPostCard, ChatBubble, and CommentItem with full interaction state support.
</objective>

<execution_context>
@/Users/johanneschristler/.claude/get-shit-done/workflows/execute-plan.md
@/Users/johanneschristler/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/10-blocks-content-social/10-RESEARCH.md
@.planning/phases/10-blocks-content-social/10-01-SUMMARY.md
@packages/registry/blocks/feed-post-card.tsx
@packages/registry/blocks/chat-bubble.tsx
@packages/registry/blocks/comment-item.tsx
</context>

<tasks>

<task type="auto">
  <name>Enhance FeedPostCard with interactive states</name>
  <files>packages/registry/blocks/feed-post-card.tsx</files>
  <action>
1. Read packages/registry/blocks/feed-post-card.tsx (if not in registry, create based on demo pattern)
2. Import socialBlockTokens: `import { socialBlockTokens } from '@metacells/mcellui-core'`
3. Add loading state props to component interface:
   - likeLoading?: boolean
   - commentLoading?: boolean
   - shareLoading?: boolean
   - disabled?: boolean
4. Update action buttons to use loading/disabled states:
   - Show ActivityIndicator when loading
   - Set disabled when loading or disabled prop is true
   - Set opacity to 0.5 when disabled
5. Add accessibility labels to all action buttons:
   - accessibilityRole="button"
   - accessibilityLabel describing action
   - accessibilityState with disabled state
6. Migrate typography to socialBlockTokens:
   - Author name: socialBlockTokens.typography.authorFontSize + authorFontWeight
   - Content: socialBlockTokens.typography.contentFontSize + contentLineHeight
   - Time: socialBlockTokens.typography.timeFontSize
7. Avatar size: socialBlockTokens.avatar.postSize ('md')
  </action>
  <verify>
cd /Users/johanneschristler/Code/metacells/other/mcellui
grep -n "socialBlockTokens" packages/registry/blocks/feed-post-card.tsx
grep -n "Loading\?:" packages/registry/blocks/feed-post-card.tsx
grep -n "accessibilityLabel" packages/registry/blocks/feed-post-card.tsx | head -5
npx tsc --noEmit -p packages/registry/tsconfig.json
  </verify>
  <done>
- FeedPostCard has likeLoading, commentLoading, shareLoading, disabled props
- Action buttons show ActivityIndicator when loading
- All action buttons have accessibilityLabel
- Typography uses socialBlockTokens values
  </done>
</task>

<task type="auto">
  <name>Enhance ChatBubble with interactive states</name>
  <files>packages/registry/blocks/chat-bubble.tsx</files>
  <action>
1. Read packages/registry/blocks/chat-bubble.tsx
2. Import socialBlockTokens: `import { socialBlockTokens } from '@metacells/mcellui-core'`
3. Add disabled prop to interface
4. Apply disabled state to container Pressable:
   - Set onLongPress to undefined when disabled
   - Set opacity to 0.5 when disabled
   - Add accessibilityRole="text"
   - Add accessibilityLabel describing message and sender
5. Migrate to socialBlockTokens.bubble values:
   - maxWidth: socialBlockTokens.bubble.maxWidth
   - padding: socialBlockTokens.bubble.paddingVertical/paddingHorizontal
6. Migrate typography:
   - Message text: socialBlockTokens.typography.contentFontSize
   - Time: socialBlockTokens.typography.timeFontSize
7. Avatar size: socialBlockTokens.avatar.chatSize ('sm')
  </action>
  <verify>
cd /Users/johanneschristler/Code/metacells/other/mcellui
grep -n "socialBlockTokens" packages/registry/blocks/chat-bubble.tsx
grep -n "disabled\?:" packages/registry/blocks/chat-bubble.tsx
grep -n "accessibilityLabel" packages/registry/blocks/chat-bubble.tsx
npx tsc --noEmit -p packages/registry/tsconfig.json
  </verify>
  <done>
- ChatBubble has disabled prop
- Disabled state prevents long press and reduces opacity
- Typography uses socialBlockTokens values
- Has accessibility labels describing message content
  </done>
</task>

<task type="auto">
  <name>Enhance CommentItem with interactive states</name>
  <files>packages/registry/blocks/comment-item.tsx</files>
  <action>
1. Read packages/registry/blocks/comment-item.tsx
2. Import socialBlockTokens: `import { socialBlockTokens } from '@metacells/mcellui-core'`
3. Add loading state props to interface:
   - likeLoading?: boolean
   - disabled?: boolean
4. Update like button with loading state:
   - Show ActivityIndicator when likeLoading
   - Disable button when disabled or likeLoading
   - Add accessibilityRole="button"
   - Add accessibilityLabel "Like comment" or "Unlike comment"
5. Update reply button with disabled state:
   - Disable when disabled prop is true
   - Add accessibilityLabel "Reply to comment"
6. Migrate to socialBlockTokens:
   - Nesting indent: socialBlockTokens.comment.indentPerLevel
   - Author name: socialBlockTokens.typography.authorFontSize + authorFontWeight
   - Content: socialBlockTokens.typography.contentFontSize
   - Time: socialBlockTokens.typography.timeFontSize
7. Avatar size: socialBlockTokens.avatar.commentSize ('sm' for replies, 'md' for top-level)
  </action>
  <verify>
cd /Users/johanneschristler/Code/metacells/other/mcellui
grep -n "socialBlockTokens" packages/registry/blocks/comment-item.tsx
grep -n "likeLoading\|disabled" packages/registry/blocks/comment-item.tsx
grep -n "accessibilityLabel" packages/registry/blocks/comment-item.tsx | head -5
npx tsc --noEmit -p packages/registry/tsconfig.json
  </verify>
  <done>
- CommentItem has likeLoading and disabled props
- Like button shows ActivityIndicator when loading
- Reply button respects disabled state
- All interactive elements have accessibility labels
- Typography uses socialBlockTokens values
  </done>
</task>

</tasks>

<verification>
```bash
cd /Users/johanneschristler/Code/metacells/other/mcellui

# Check all social blocks import socialBlockTokens
grep -l "socialBlockTokens" packages/registry/blocks/{feed-post-card,chat-bubble,comment-item}.tsx

# Verify loading props exist
grep -n "Loading\?:" packages/registry/blocks/{feed-post-card,chat-bubble,comment-item}.tsx

# Verify disabled props exist
grep -n "disabled\?:" packages/registry/blocks/{feed-post-card,chat-bubble,comment-item}.tsx

# Verify accessibility labels
grep -n "accessibilityLabel" packages/registry/blocks/{feed-post-card,chat-bubble,comment-item}.tsx | head -10

# TypeScript compilation
npx tsc --noEmit -p packages/registry/tsconfig.json
```
</verification>

<success_criteria>
- [ ] FeedPostCard has likeLoading, commentLoading, shareLoading, disabled props
- [ ] ChatBubble has disabled prop for long press
- [ ] CommentItem has likeLoading and disabled props
- [ ] All action buttons show ActivityIndicator when loading
- [ ] All action buttons are disabled during loading (prevent double-tap)
- [ ] All interactive elements have accessibilityLabel
- [ ] Typography uses socialBlockTokens (author, content, time sizes)
- [ ] Icon sizes standardized to socialBlockTokens.action.iconSize (20px)
- [ ] TypeScript compiles without errors
</success_criteria>

<output>
After completion, create `.planning/phases/10-blocks-content-social/10-03-SUMMARY.md`
</output>
