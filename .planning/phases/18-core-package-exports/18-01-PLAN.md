---
phase: 18-core-package-exports
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - packages/core/src/index.ts
  - packages/core/src/theme/index.ts
  - packages/core/src/theme/components.ts
  - packages/core/src/constants.ts
autonomous: true

must_haves:
  truths:
    - "No orphaned exports remain in the core package"
    - "All exports used by registry components are present and importable"
    - "SKELETON_CONSTANTS removed (duplicate of skeletonTokens.animation)"
    - "screenTokens and SCREEN_CONSTANTS removed (unused by any component)"
  artifacts:
    - path: "packages/core/src/index.ts"
      provides: "Root barrel export without orphaned symbols"
    - path: "packages/core/src/theme/index.ts"
      provides: "Theme barrel export without orphaned symbols"
    - path: "packages/core/src/theme/components.ts"
      provides: "Component tokens without orphaned screenTokens/SCREEN_CONSTANTS"
    - path: "packages/core/src/constants.ts"
      provides: "Constants without orphaned SKELETON_CONSTANTS"
  key_links:
    - from: "packages/core/src/index.ts"
      to: "packages/registry/**/*.tsx"
      via: "import from @metacells/mcellui-core"
      pattern: "from ['\"]@metacells/mcellui-core['\"]"
---

<objective>
Remove orphaned exports and verify export completeness for the core package.

Purpose: Ensure CORE-03 (no orphaned exports) is addressed and CORE-01/CORE-02 export completeness is verified. This cleanup must happen before documentation (Plan 02) so we don't document dead code.

Output: Clean core package with no orphaned exports, verified import coverage across all registry components.
</objective>

<execution_context>
@/Users/johanneschristler/.claude/get-shit-done/workflows/execute-plan.md
@/Users/johanneschristler/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@packages/core/src/index.ts
@packages/core/src/theme/index.ts
@packages/core/src/theme/components.ts
@packages/core/src/constants.ts
@packages/core/src/utils/index.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Verify orphan status and remove 3 confirmed orphans</name>
  <files>
    packages/core/src/theme/components.ts
    packages/core/src/theme/index.ts
    packages/core/src/constants.ts
    packages/core/src/index.ts
  </files>
  <action>
    1. Verify no component or demo uses the 3 confirmed orphans by running:
       - `grep -r "screenTokens" packages/registry/ apps/demo/ --include="*.tsx" --include="*.ts"`
       - `grep -r "SCREEN_CONSTANTS" packages/registry/ apps/demo/ --include="*.tsx" --include="*.ts"`
       - `grep -r "SKELETON_CONSTANTS" packages/registry/ apps/demo/ --include="*.tsx" --include="*.ts"`
       If any usage is found, do NOT remove that export — instead document the finding.

    2. Remove `screenTokens` and `SCREEN_CONSTANTS` from:
       - `packages/core/src/theme/components.ts` (remove the export declarations/objects)
       - `packages/core/src/theme/index.ts` (remove from re-export list)
       - `packages/core/src/index.ts` (remove from theme re-export block, lines ~104-105)

    3. Remove `SKELETON_CONSTANTS` from:
       - `packages/core/src/constants.ts` (remove the object and its type export `SkeletonConstants`)
       - The root index.ts re-exports via `export * from './constants'` so removing from constants.ts is sufficient.

    4. Run a broader orphan scan: extract all named exports from `packages/core/src/index.ts` and compare against all imports from `@metacells/mcellui-core` in `packages/registry/` and `apps/demo/`. Log any additional exports that have zero internal consumers (these are likely legitimate public API — just document them, don't remove without verification).
  </action>
  <verify>
    - `grep -r "screenTokens\|SCREEN_CONSTANTS\|SKELETON_CONSTANTS" packages/core/src/` returns NO results
    - `npx tsc --noEmit -p packages/core/tsconfig.json` passes (or `npm run type-check` in packages/core)
    - No TypeScript import errors across the monorepo: `npx turbo run type-check --filter=@metacells/mcellui-core`
  </verify>
  <done>
    3 orphaned exports (screenTokens, SCREEN_CONSTANTS, SKELETON_CONSTANTS) removed. No component has broken imports. Any additional orphan candidates documented but not removed.
  </done>
</task>

<task type="auto">
  <name>Task 2: Verify export completeness across all subpaths</name>
  <files>
    packages/core/src/index.ts
    packages/core/src/tokens/index.ts
    packages/core/src/utils/index.ts
  </files>
  <action>
    1. Verify the root barrel (`packages/core/src/index.ts`) re-exports everything from:
       - `./theme` (theme system — primary API)
       - `./tokens` (legacy token subset)
       - `./config` (configuration)
       - `./utils` (utility functions)
       - `./primitives` (Pressable, Portal, Slot)
       - `./components` (ErrorBoundary)
       - `./constants` (magic numbers)

    2. Verify the tokens subpath (`packages/core/src/tokens/index.ts`) exports all token files:
       - colors, spacing, typography, radius, shadows
       Check that each file's exports are re-exported.

    3. Verify the utils subpath (`packages/core/src/utils/index.ts`) exports all utility files:
       - cn, platform, accessibility, haptics, expoGo, typography
       Check that each file's exports are re-exported.

    4. Check for any types exported from sub-modules that are NOT re-exported through the barrel. Specifically:
       - `SpacingValue` from theme/spacing.ts (exported in theme/index.ts but NOT in root index.ts)
       - `RadiusValue`, `ComponentRadiusKey`, `ComponentRadiusTokens` from theme/radius.ts
       - `LineHeightKey`, `LetterSpacingKey` from theme/typography.ts
       If any types are missing from the root barrel, add them to the root barrel's theme re-export block.

    5. Verify package.json exports map is correct:
       - `.` → `dist/index.js` + `dist/index.d.ts`
       - `./tokens` → `dist/tokens/index.js` + `dist/tokens/index.d.ts`
       - `./utils` → `dist/utils/index.js` + `dist/utils/index.d.ts`
       - `./package.json` → `./package.json`

    6. If any missing type re-exports found in step 4, add them to the root `index.ts` theme export block.
  </action>
  <verify>
    - `npx tsc --noEmit -p packages/core/tsconfig.json` passes
    - All subpath exports resolve: verify that `packages/core/src/tokens/index.ts`, `packages/core/src/utils/index.ts` exist and export correctly
    - The root index.ts re-exports all types from theme/index.ts (compare export counts)
  </verify>
  <done>
    All exports verified complete. Any missing type re-exports added to root barrel. All 3 subpaths (root, /tokens, /utils) confirmed working. Package.json exports map verified correct.
  </done>
</task>

</tasks>

<verification>
1. `grep -r "screenTokens\|SCREEN_CONSTANTS\|SKELETON_CONSTANTS" packages/core/src/` returns zero results
2. TypeScript type-check passes for core package
3. All registry components still compile without errors
4. Root, /tokens, and /utils subpaths all resolve correctly
</verification>

<success_criteria>
- Zero orphaned exports remain (3 confirmed + any discovered)
- All theme token types are re-exported through root barrel
- All utility functions are exported through both root and /utils subpath
- TypeScript compilation passes across the monorepo
</success_criteria>

<output>
After completion, create `.planning/phases/18-core-package-exports/18-01-SUMMARY.md`
</output>
